<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/socket.io/client-dist/socket.io.min.js"></script>
    <title>Talk To StudyGPT</title>
</head>
<body>
  <div id="output"></div>
  <button id="show">Toggle Conversation</button>
    <button id="chat">Start Voice Chat</button>
    <script>
      var output = "";
        const socket = io();
document.getElementById("show").onclick = ()=> {
  if(document.querySelector("#output").innerHTML.length === 0) document.querySelector("#output").innerHTML = output;
  else if(document.querySelector("#output").innerHTML.length > 0) document.querySelector("#output").innerHTML = "";
}
        var recognition =  new webkitSpeechRecognition();
  
  recognition.lang = "en-US";
  recognition.continuous = false;
  recognition.interimResults = false;
  recognition.maxAlternatives = 1;
  document.getElementById("chat").onclick = () => {
  recognition.start();
  document.getElementById("chat").innerHTML = "Talk Back";
  recognition.addEventListener("speechend", () => {
    recognition.stop();
});
recognition.onresult = (event) => {
  var chat = event.results[event.results.length -1][0].transcript;
  console.log(chat);
  output += "<strong>You said: </strong>"+chat + "<br><br>";
  socket.emit("audio", chat);
};
};
socket.on("talk",  speech=> {
   speechSynthesis.speak(new SpeechSynthesisUtterance(speech))
output += "<strong>StudyGPT said: </strong>"+ speech + "<br><br>";
})
    </script>
    
</body>
</html>